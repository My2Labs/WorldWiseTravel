import { createContext, useContext, useReducer } from "react";

const AuthContext = createContext();

const initialState = {
  user: null,
  isAuthenticated: false,
};

function reducer(state, action) {
  switch (action.type) {
    case "login":
      return { ...state, user: action.payload, isAuthenticated: true };
    case "logout":
      return { ...state, user: null, isAuthenticated: false };
    default:
      throw new Error("Unknown action");
  }
}

const AUTH_USER = {
  name: "Sharron",
  email: "sharron@example.com",
  password: "foo-bar",
  avatar:
    "data:image/png;base64,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",
};

function AuthProvider({ children }) {
  const [{ user, isAuthenticated }, dispatch] = useReducer(
    reducer,
    initialState
  );

  function login(email, password) {
    if (email === AUTH_USER.email && password === AUTH_USER.password)
      dispatch({ type: "login", payload: AUTH_USER });
  }

  function logout() {
    dispatch({ type: "logout" });
  }

  return (
    <AuthContext.Provider value={{ user, isAuthenticated, login, logout }}>
      {children}
    </AuthContext.Provider>
  );
}

function useAuth() {
  const context = useContext(AuthContext);
  if (context === undefined)
    throw new Error("AuthContext was used outside AuthProvider");
  return context;
}

export { AuthProvider, useAuth };
